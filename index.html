<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>mockery.core - Mockery API documentation</title>
    <link rel="icon" href="static/favicon.png" />
    <link rel="shortcut icon" href="static/favicon.png" />
    <link rel="stylesheet" href="static/clojure.css" type="text/css" media="all" />
    <link rel="stylesheet" href="static/wiki.css" type="text/css" media="all" />
    <link rel="stylesheet" href="static/internal.css" type="text/css" media="all" />
    <style>.menuWrapper{height: 36px;}</style>
  </head>
<!--
This document was auto-generated from the source by the clojure autodoc system.
To report errors or ask questions about the overall documentation structure, formatting,
etc., contact Tom Faulhaber (google mail name: tomfaulhaber).
For errors in the documentation of a particular namespace, contact the author of that
namespace.
-->
  <body>
    <div id="AllContentContainer">
      <div id="Header">
	<a href="index.html" id="Logo"><img src="static/clojure-icon.gif" width="100" height="100" alt="Clojure" /></a>
	<h1><a href="index.html" id="page-header" title="page header title">Mockery API Documentation</a></h1>
      </div>
      <div id="leftcolumn"><div style="text-align: center;"></div>
<div class="menu">
  <div class="WikiCustomNav WikiElement wiki">
    <span class="toc-header"><span id="project-name">Mockery</span> <span id="version"></span> API</span><br />
    <ul>
      <li><a href="index.html" class="wiki_link">Overview</a></li>
      <li><a href="api-index.html" class="wiki_link">API Index</a></li>
    </ul>
    
    
    <a class="wiki_link" href="http://clojure.org">Clojure Home</a>
  </div>
</div>
</div>
      <div id="rightcolumn">
	<div id="Content">
	  <div class="contentBox"><div class="innerContentBox">
              <div class="wiki wikiPage" id="content_view">
                <div id="right-sidebar"><div id="toc">
  <h1 class="nopad">Table of Contents</h1>
  <div class="toc-section" style="margin-left: 1em;">
    <a style="margin-top: 3px;" href="#toc0">Overview</a>
    
  </div><div class="toc-section" style="margin-left: 1em;">
    <a style="margin-top: 3px;" href="#"></a>
    
  </div><div class="toc-section" style="margin-left: 1em;">
    <a style="margin-top: 3px;" href="#"></a>
    
  </div><div class="toc-section" style="margin-left: 1em;">
    <a style="margin-top: 3px;" href="#var-section">Vars and Functions</a>
    <div class="toc-entry" style="margin-left: 1em;">
      <a href="#mockery.core/make-mock" class="toc-entry-anchor">make-mock</a>
      
    </div><div class="toc-entry" style="margin-left: 1em;">
      <a href="#mockery.core/make-mock-fn" class="toc-entry-anchor">make-mock-fn</a>
      
    </div><div class="toc-entry" style="margin-left: 1em;">
      <a href="#mockery.core/resolve!" class="toc-entry-anchor">resolve!</a>
      
    </div><div class="toc-entry" style="margin-left: 1em;">
      <a href="#mockery.core/with-mock" class="toc-entry-anchor">with-mock</a>
      
    </div><div class="toc-entry" style="margin-left: 1em;">
      <a href="#mockery.core/with-mocks" class="toc-entry-anchor">with-mocks</a>
      
    </div>
  </div><div class="toc-section" style="margin-left: 1em;">
    <a style="margin-top: 3px;" href="#"></a>
    
  </div>
</div>
</div>
                <div id="content-tag"><h1 id="overview">API for <span id="mockery.core">mockery.core</span>
  - <span id="header-project">Mockery</span> <span id="header-version"></span>
  </h1>

<br />Full namespace name: <span id="long-name">mockery.core</span>
<p></p>
<h2>Overview</h2>

<pre id="namespace-docstr">A library to mock Clojure functions.</pre>


<br />



<div id="var-section">
  <p></p>
  <h2>Public Variables and Functions</h2>
  <div id="var-entry">
    <br />
    <hr />
    <h2 id="mockery.core/make-mock">make-mock</h2>
    <span id="var-type">function</span><br />
    <pre id="var-usage">Usage: (make-mock opt)
</pre>
    <pre id="var-docstr">Retuns an atom the represents a mock.</pre>
    <pre id="var-specs"></pre>
    
    
    <a id="var-source" href="https://github.com/igrishaev/mockery/blob/0986061885217c658d68f35462bceb9c352bb81b/src/mockery/core.clj#L17">Source</a>
  </div><div id="var-entry">
    <br />
    <hr />
    <h2 id="mockery.core/make-mock-fn">make-mock-fn</h2>
    <span id="var-type">function</span><br />
    <pre id="var-usage">Usage: (make-mock-fn mock)
</pre>
    <pre id="var-docstr">Returns a function to substitute a target.
Calling this function will change the mock's state.</pre>
    <pre id="var-specs"></pre>
    
    
    <a id="var-source" href="https://github.com/igrishaev/mockery/blob/0986061885217c658d68f35462bceb9c352bb81b/src/mockery/core.clj#L36">Source</a>
  </div><div id="var-entry">
    <br />
    <hr />
    <h2 id="mockery.core/resolve!">resolve!</h2>
    <span id="var-type">function</span><br />
    <pre id="var-usage">Usage: (resolve! target)
</pre>
    <pre id="var-docstr">Resolves a variable by either a symbol or keyword.
Rises an assertion error if not found.</pre>
    <pre id="var-specs"></pre>
    
    
    <a id="var-source" href="https://github.com/igrishaev/mockery/blob/0986061885217c658d68f35462bceb9c352bb81b/src/mockery/core.clj#L69">Source</a>
  </div><div id="var-entry">
    <br />
    <hr />
    <h2 id="mockery.core/with-mock">with-mock</h2>
    <span id="var-type">macro</span><br />
    <pre id="var-usage">Usage: (with-mock mock opt &amp; body)
</pre>
    <pre id="var-docstr">Runs the code block substituting a target function with a dummy
one ("mock" function). This dummy function behaves the way you
determine with options. It counts the number of calls, accumulates
it's arguments, can cause side effects or rise a given
exception. Once you go out from the macro, the target function will
obtain it's origin value.

Arguments:

- `mock`: a symbol to bind a mock instance inside the code block,

- `opt`: a map with the following parameters:

-- `:target` (required): a symbol or a keyword points to a target
function to mock. May include a namespace (be full-qualified).

-- `:value`: any value to return from a mocked function. If it's a
function by itself (defn, fn or #(...)), it will be called
afterwards.

-- `:side-effect`: any function with no arguments that is triggered
when calling a target function.

-- `:throw`: either an Exception instance to be thrown with the
standard `throw` pipeline or any map to be thrown with `(ex-info)`
wrapper. Useful to simulate runtime exceptions.

More on mock instance.

The mock instance you have bound to the `mock` parameter is an atom
holds a map. It extends the `opt` map described above. In addition
to those immutable fields, it has the following ones:

-- `:called?`: a boolean flag indicates whether a function was called
at least one time or not. `false` by default.

-- `:call-count`: a number times the function was called. 0 by default.

-- `:call-args`: the last arguments were passed to the
function. `nil` by default.

-- `:call-args-list`: a vector of all the args were passed, `[]` by
default.

Example:

(with-mock mock
  {:target :clojure.pprint/pprint
   :return ":-)"
   :side-effect #(println "Hi!")}
  (clojure.pprint/pprint {:foo 42}))

Hi!
:-)

Once you deref the `mock` variable inside the code block, you'll get:

{:called? true
 :call-count 1
 :call-args ({:foo 42})
 :call-args-list [({:foo 42})]
 :target :clojure.pprint/pprint
 :return ":-)"
 :side-effect #function[mockery.core/eval12666/fn--12667]}

Checking `:call-count` and `:call-args` might be good for your unit
tests.</pre>
    <pre id="var-specs"></pre>
    
    
    <a id="var-source" href="https://github.com/igrishaev/mockery/blob/0986061885217c658d68f35462bceb9c352bb81b/src/mockery/core.clj#L107">Source</a>
  </div><div id="var-entry">
    <br />
    <hr />
    <h2 id="mockery.core/with-mocks">with-mocks</h2>
    <span id="var-type">macro</span><br />
    <pre id="var-usage">Usage: (with-mocks bind-opt &amp; body)
</pre>
    <pre id="var-docstr">Like `with-mock` but for multiple mocks at once. `bind-opt` is a
vector where each odd item is a bind symbol and even item is an
option map. See `with-mock` for detailed description of each
parameter.</pre>
    <pre id="var-specs"></pre>
    
    
    <a id="var-source" href="https://github.com/igrishaev/mockery/blob/0986061885217c658d68f35462bceb9c352bb81b/src/mockery/core.clj#L88">Source</a>
  </div>
</div>


</div>
              </div>
            </div>
          </div>
	</div>
	<div id="foot">
	  <div id="copyright" style="text-align: center;">2017 Ivan Grishaev</div>
	</div>
      </div>
      <div id="DesignedBy">Logo &amp; site design by <a href="http://www.tomhickey.com" title="Visit Tom Hickey's website.">Tom Hickey</a>.<br />
      Clojure auto-documentation system by Tom Faulhaber.</div>
    </div>
    <!-- /AllContentContainer -->
  </body>

</html>